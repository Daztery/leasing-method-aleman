{% extends "leasing/base.html" %}
{% block content %}

<div class="row">
    <div class ="col-4">
        <form style="margin-bottom:20px;" method='POST' action=''>
            {% csrf_token %}
            Buscar periodo:<br>
            <input style="width:40px;" type="number" name="nPeriodo">
            <br>
            <br>
            <input class="btn btn-outline-primary" type="submit" name= "buscar" value="buscar">
            <a class="btn btn-outline-primary"  href="{% url 'prestamo-update' pk %}">Editar</a>
        </form>
    </div>
    <div class ="col-6">
        <form style="margin-bottom:20px;" method='POST' action=''>
            {% csrf_token %}
            Filtrar entre periodos:<br>
            <input style="width:40px; margin-right:20px;" type="number" name="periodoI">
            <input style="width:40px;" type="number" name="periodoF">
            <br>
            <br>
            <input class="btn btn-outline-primary" type="submit" name= "filtrar" value="filtrar">
        </form>
    </div>
    
</div>

<div style="width:100%;">
    <header style="background-color:#150250;" class="p-3 text-white text-center">
        <div class="row">
            <div class="col-2">
                <h5 style="color: white; margin-left:20px; margin-top:15px;">{{ prestamo.empresa_solicitante.razon_social }} </h5>
            </div>
            <div class="col-7">
                <h5 style="color: white; margin-left:70px; margin-top:15px;">Flujo de caja por Método Alemán</h5>
            </div>
            <div class ="col-3">
                <a  class="btn btn-primary "  href="{% url 'prestamo-detail' pk %}">Ver resultados</a>
            </div>
        </div>
    </header>
    <table class="table table-hover table-striped" style="margin-bottom:80px;">
        <thead>
            <tr style="background-color: #898989; color: white; text-align:center"> 
                <th scope="col" style="font-weight: 500;">Nº</th>
                <th scope="col" style="font-weight: 500;">Saldo Inicial</th>
                <th scope="col" style="font-weight: 500;">Interés</th>
                <th scope="col" style="font-weight: 500;">Cuota</th>
                <th scope="col" style="font-weight: 500;">Amortización</th>
                <th scope="col" style="font-weight: 500;">Seguro riesgo</th>
                <th scope="col" style="font-weight: 500;">Comisión</th>
                <th scope="col" style="font-weight: 500;">Recompra</th>
                <th scope="col" style="font-weight: 500;">Saldo Final</th>
                <th scope="col" style="font-weight: 500;">Depreciación</th>
                <th scope="col" style="font-weight: 500;">Ahorro tributario</th>
                <th scope="col" style="font-weight: 500;">IGV</th>
                <th scope="col" style="font-weight: 500;">Flujo bruto</th>
                <th scope="col" style="font-weight: 500;">Flujo IGV</th>
                <th scope="col" style="font-weight: 500;">Flujo neto</th>
            </tr>
        </thead>
        <tbody>
        {% for table in tables %}
        <tr style="text-align:center"> 
            {% if table.n in numPeriodos %}
                <td>{{ table.n }}</td>
                <td>{{ table.saldo_inicial|floatformat:2 }}</td>
                <td>{{ table.interes|floatformat:2 }}</td>
                <td>{{ table.Cuota|floatformat:2 }}</td>
                <td>{{ table.amortizacion|floatformat:2 }}</td>
                <td>{{ table.seguro_riesgo|floatformat:2 }}</td>
                <td>{{ table.comision|floatformat:2 }}</td>
                <td>{{ table.recompra|floatformat:2 }}</td>
                <td>{{ table.saldo_final|floatformat:2 }}</td>
                <td>{{ table.depreciacion|floatformat:2 }}</td>
                <td>{{ table.ahorro_t|floatformat:2 }}</td>
                <td>{{ table.igv|floatformat:2 }}</td>
                <td>{{ table.flujo_b|floatformat:2 }}</td>
                <td>{{ table.flujo_igv|floatformat:2 }}</td>
                <td>{{ table.flujo_neto|floatformat:2 }}</td>

            {% elif query == table.n|stringformat:"i" %}
                <td>{{ table.n }}</td>
                <td>{{ table.saldo_inicial|floatformat:2 }}</td>
                <td>{{ table.interes|floatformat:2 }}</td>
                <td>{{ table.Cuota|floatformat:2 }}</td>
                <td>{{ table.amortizacion|floatformat:2 }}</td>
                <td>{{ table.seguro_riesgo|floatformat:2 }}</td>
                <td>{{ table.comision|floatformat:2 }}</td>
                <td>{{ table.recompra|floatformat:2 }}</td>
                <td>{{ table.saldo_final|floatformat:2 }}</td>
                <td>{{ table.depreciacion|floatformat:2 }}</td>
                <td>{{ table.ahorro_t|floatformat:2 }}</td>
                <td>{{ table.igv|floatformat:2 }}</td>
                <td>{{ table.flujo_b|floatformat:2 }}</td>
                <td>{{ table.flujo_igv|floatformat:2 }}</td>
                <td>{{ table.flujo_neto|floatformat:2 }}</td>
            {% elif valor != 's'  %}
                <td>{{ table.n }}</td>
                <td>{{ table.saldo_inicial|floatformat:2 }}</td>
                <td>{{ table.interes|floatformat:2 }}</td>
                <td>{{ table.Cuota|floatformat:2 }}</td>
                <td>{{ table.amortizacion|floatformat:2 }}</td>
                <td>{{ table.seguro_riesgo|floatformat:2 }}</td>
                <td>{{ table.comision|floatformat:2 }}</td>
                <td>{{ table.recompra|floatformat:2 }}</td>
                <td>{{ table.saldo_final|floatformat:2 }}</td>
                <td>{{ table.depreciacion|floatformat:2 }}</td>
                <td>{{ table.ahorro_t|floatformat:2 }}</td>
                <td>{{ table.igv|floatformat:2 }}</td>
                <td>{{ table.flujo_b|floatformat:2 }}</td>
                <td>{{ table.flujo_igv|floatformat:2 }}</td>
                <td>{{ table.flujo_neto|floatformat:2 }}</td>
                {% endif %}
        </tr>
        {% endfor %}
        </tbody>
    </table>

    <form style="margin-bottom:80px;" method='POST' action=''>
        {% csrf_token %}
        <input style="width:40px; margin-right:20px;" type="hidden" value="{{ periodoI }}" name="periodoIPDF">
        <input style="width:40px;" type="hidden" value="{{ periodoF }}" name="periodoFPDF">
        <input style="width:40px;" type="hidden" value="{{ query }}"  name="nPeriodoPDF">
        <input type="{{ iType }}" class="btn btn-outline-primary" name= "PDF" value="Guardar PDF">
    </form>
</div>  
{% endblock content %}